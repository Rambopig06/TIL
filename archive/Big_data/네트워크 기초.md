# 네트워크

필자가 시험 대비해서 정리한 놋북.

## TCP/IP 4계층 정리

|담당|TCP/IP 4계층|식별자|전송단위|프로토콜|
|--|--|--|--|--|
|애플리케이션|응용 계층||Message|HTTP , Socket|
|운영체제(OS)|전송 계층<br/><br/>네트워크 계층|Port번호<br/>IP주소|Segment<br/>Packet|TCP , UDP , IP(라우팅 알고리즘) , ARP , ICMP|
|Network Card(H/W)|링크 계층|MAC주소|Frame|MAC protocol(이더넷:CSMA/CD)|

### 계층간 역할 정리

#### 꿀팁1- 계층의 이름은 순서대로 '응전네데'로 외울 것.
#### 꿀팁2 - 전송 단위는 순서대로 '비프패스'로 외울 것.

1. 응용 계층(다양한 응용 프로그램) : **사용자 어플리케이션** 에서 사용하는 프로토콜.(HTTP , DNS , SMTP , FTP , SSH , Telnet)

2. 전송계층(**종단간 신뢰성** 있는 데이터 전송): 통신 노드간의 연결 제어 및 자료 송수신을 담당.<br/>
**TCP** :연결형 , 신뢰성<br/>
**UDP** :비연결형 , 비신뢰성

3. **인터넷 계층(패킷을 목적지까지 전달)또는 네트워크 계층이라고도 함**: 최종 목적지까지 정확하게 연결되도록 경로 설정: 라우팅<br/>
Host를 구분하기 위해 주소를 할당 : IP 주소<br/>
IP(Internet Protocol) : 호스트들과 네트워크에서 주소 관리, 패킷을 라우팅

4. **데이터 링크계층(인접 노드간 데이터 전송 담당)** : 물리적으로 데이터가 네트워크를 어떻게 전송되는지를 정의, 물리주소(MAC주소)를 사용<br/>
예) Ethernet , WiFi등


[ MAC Header | IP Header | (TCP Header | **Data**)]

**컴퓨터 네트워크의 정의** : 컴퓨터들이 통신기술을 이용하여 그물망처럼 연결된 통신망

-> 분산되어 있는 컴퓨터들을 자원이나 정보를 공유하기 위하여 통신망으로 연결한 것

**네트워크의 장점** : 

- 데이터(정보)공유 : **네트워크**를 통해 많은 사람들이 여러 데이터를 조회,고융

- 하드웨어 공유 : 비용 절감과 자원 활용 효율성 제공<br/>
예) 클라우드 컴퓨팅은 유연성 , 확장성 , 접근성을 향상

- 데이터 관리 용이 : 네트워크를 이용하면 공유 서버를 통해 데이터를 쉽게 관리

**네트워크의 단점** :

보안문제 : 개인정보 유출 , 바이러스 , 해킹 등 -> 네트워크 보안필요


**네트워크 구성요소**

- *노드(Node)* : 네트워크에 연결되어 있는 시스템(PC , 서버 , 라우터 , 스위치 등)

- *링크(link)* : 노드간 연결된 전송매체

- *호스트(Host)* : 응용 프로그램을 수행하는 주체(역할에 따라 서버와 클라이언트로 구분)

- *라우터(router)* : IP주소를 이용하여 목적지까지의 최적 경로를 결정하여 라우팅 해주는 네트워크 장비.


## 라우팅 과정

- *프로토콜* : 서로 다른 노드(혹은 호스트)에 위치한 **동일 계층** 사이의 통신 규칙

- *인터페이스* : 같은 노드(혹은 호스트)에 위치한 **상하위 계층** 사이의 통신 규칙

**프로토콜과 인터페이스 예시(가로 버전)**
```
Client -(이런게 인터페이스임)-> HTTP -> TCP -> IP -> Ethernet

(끝지점인 네트워크에서 교류)

Server <- HTTP <- TCP <- IP <- Ethernet
```
이 그림에서 예시를 들어, *HTTP <-> HTTP* 끼리 통신하는 규약이 **프로토콜** 임.


## 계층 구조에서 데이터 전송과정 : 캡슐화와 역캡슐화

**캡슐화** : 데이터를 **보내는 쪽**에서 **상위 계층의 프로토콜 정보**를 **데이터에 추가**하여 하위 계층으로 전송하는 과정.

*볼드체는 프로토콜 정보를 추가하는 헤더이다.*

|순서||||||
|--|--|--|--|--|--|
|1|||||**Data**|
|2||||**TCP**|Data|
|3|||**IP**|TCP|Data|
|4|**Data Link**|IP|TCP|Data|Data Link|

**역 캡슐화** : 데이터를 **받는 쪽**에서는 계층마다 헤더를 하나씩 제거하는 과정,

*용어 설명(헤더)* : TCP , IP , Data 이런게 계층의 헤더임.


|순서||||||
|--|--|--|--|--|--|
|1|Data Link|IP|TCP|Data|Data Link|
|2|||IP|TCP|Data|
|3||||TCP|Data|
|4|||||Data|

## IP 주소(IPv4 주소)

- 네트워크상에서 컴퓨터(Host)를 구분하기 위해 부여된 주소.

- IPv4 주소는 **32비트의 이진 숫자로 구성**, 보통 8비트씩 네 부분으로 나누어 십진수로 표현

- 32bit(4byte) 길이로 구성된 논리적인 주소체게(**2³²** 개 IP 주소 배정 가능.)

**내 컴퓨터 IP 주소 확인 방법** : cmd에 ipconfig 또는 ipconfig/all 명령을 실행.

**IP 주소 배정에도 규칙이 있다**<br/>
IP 주소는 네트워크 주소와 호스트 주소 두 부분으로 나뉜다.

## IP 주소 = Network 주소 + Host 주소

**네트워크 주소** : 어떤 네트워크에 속해 있는지 알려주는 주소.

**호스트 주소** : 해당 네트워크 내에 존재하는 호스트를 구분하기 위한 주소.

**서브넷 마스크(AND 연산)** : IP 주소와 네트워크 주소를 구분하는 구분자. 2진수 숫자 1은 네트워크 주소, 0은 호스트 주소로 표시

IP 주소 : 192.168.0. | 2<br/>
서브넷 마스크 : 255.255.255.|0

| 을 기준으로 왼쪽은 네트워크, 오른쪽은 호스트 주소

## 네트워크 토플로지

**토플로지** : 컴퓨터들을 물리적으로 연결해 놓은 연결구조

- 버스형 : 하나의 중앙 통신 케이블(버스)에 여러 노드를 연결하는 방식.

- 링형 : 모든 노드가 원형(링)으로 연결. 데이터가 한방향으로 순차적으로 전달. 토큰 사용

- 스타형 : 중앙에 있는 중계장치(허브나 스위치)에 모든 노드를 1:1로 연결하는 방식.


## 웹(WWW) 개요

인터넷을 이용해 할 수 있는 기능중의 하나(인터넷 >> 웹)

-> **진짜 이 뜻 뿐임. 뜻이 겁나 옹졸함**

멀리 떨어져 있는 컴퓨터간 **문서를** 주고 받기 위해 탄생.

-> **월드 와이드 웹인 이유.**

## URL (Uniform Resource Locator)

네트워크 상에서 **리소스가** 어디 있는지 알려주기 위한 주소체계.

**URL형식->무조건 암기** : "프로토콜//호스트주소(IP주소 또는 도메인 네임):포트번호/자원 위치(경로)"

예시)
```
https://map.naver.com(:443)/p/search/경기과학기술대학교?c=15.00.0.0.2.dh

프로토콜 : https://

호스트주소 : map.naver.com

포트번호 : (:443)

경로 : /p/search/경기과학기술대학교

쿼리 스트링 : ?c=15.00.0.0.2.dh

```
#### URL에서 각자의 역할

**프로토콜** : 어떤 프로토콜을 사용하는지를 알려주는 역할(http 또는 https)

**호스트** : 해당 웹사이트의 도메인 주소(네임 서버)

**포트번호** : URL엔 생략되어 있는데 그 이유(**http는 80, https는 443이 기본포트.**)

**경로(영어로 path)** : 해당 웹사이트의 **더 자세한** 경로

**쿼리 스트링** : 형식은 URL에서 "?"뒤에 **조건에 맞는 파라미터**가 따라오며 입력 파라미터를 전달할 때 사용

*파라미터 : 시스템, 함수, 변수 등의 동작이나 특성을 결정하는 임의의 값*

## DNS(Domain Name Service)

역할 : **도메인 이름 -> Ip 주소로 변환**

- 사용자가 기억하기 쉽도록 만들어진 **도메인 이름(예: naver.com)을** 컴퓨터가 이해하는 **IP 주소(예:223.130.192.247)** 로 변환해주는 시스템.

#### DNS 가 어떻게 작동하여 역할을 해내는가?

도메인 : www.naver.com<br/>
목적지 IP : 223.130.192.247
```
client -> DNS 서버 -> 서버

예시)
client <-> naver.com
사이를 

client -> (www.naver.com) -> DNS
DNS -> (223.130.192.247) -> client

이렇게 주고 받으며 전달.
```

## HTTP 프로토콜 개요

서버와 클라이언트간 **HTML 문서를 주고받기 위한** 통신 규약.

클라이언트가 보내는 **요청 메시지**와 서버가 응답하는 **응답 메시지**의 양식을 규정.

HTTPS 는 다 똑같은데 **보안을 한스푼 얹었다**고 보셈.

### 1 . 클라이언트 - 서버 간 구조 : 단방향 통신(클라이언트가 요청, 서버가 응답)

- 클라이언트의 요청과 서버의 응답에 의해 동작하는 간단한 프로토콜.

- 동작 원리 : 

(**HTTP 클라이언트** 가 서버에 요청을 전송,요청 메서드,URL,HTTP버전,기타 부가 정보 등 포함)

(**HTTP 서버** 가 요청의 결과인 응답 코드가 포함된 정보를 회신)

**메서드** : 특정 기능을 수행하기 위한 코드가 모여있는 프로그래밍에서의 함수 (별도의 용어 정리임)


### 2. 비 연결성 : HTTP 는 기본적으로 비연결성이지만 HTTP 1.1 부터 지속 연결도 가능.

- 클라이언트와 서버가 **한 번 연결을 맺은 후**, 클라이언트 요청에 대해 **서버가 응답을 마치면 맺었던 연결을 끊어버리는** 성질.

이었지만?

- HTTP 1.1부터 **HTTP 지속 연결이 가능하다~**

### 3. 비 상태성

- 서버가 **클라이언트의 상태**를 보존하지 않음.

- 서버는 클라이언트 요청정보에 대해서만 응답하며 , 이전 요청과는 무관.


## HTTP 요청 메시지 구조(어려워 보이지만 쉬움)

```
GET /doc/test.html HTTP/1.1
Host: www.test101.com
Accept : image/gif, image/jpeg, */*
Acept-Language: en-us
Accept-Encoding : gzip, deflate
User-Agent : Mozilla/4.0
Content-Length : 35

bookId=12345&author=Tan+Ah+Teck
```

HTTP 요청메시지는 이런식으로 구성되어있다.<br/>
Content-Length 기준으로 한줄 띄워져 있는데<br/>
이걸 **Black-Line(공백)** 이라고 함.<br/>
<br/>
**헤더와 바디를** 구분하기 위한거.

### 요청 메세지 구조

- 요청메세지는 3가지 부분으로 구성.

1. HTTP method
2. URL
3. HTTP version

위에 메세지 양식 **첫줄만**을 하나하나 분해해보면,

```
GET /doc/test.html HTTP/1.1

- GET (HTTP Method)

- /doc/test.html(URL)

- /1.1(HTTP 버전)
```
**HTTP Method** : 클라이언트가 웹 서버에게 요청하는 목적을 알리는 수단.<br/>
<br/>
*종류* : 에 앞서, 데이터 전달 방식은 **바디**이다.<br/>
**GET방식** : 서버로 정보를 **요청하는** 목적<br/>(**바디 사용 없이** URL에 쿼리 스트링으로 데이터 전달)<br/>
<br/>
*POST방식* : 서버로 정보를 **전달하는** 목적<br/>(주는 개념보다는 줄테니 처리해서 내놓으라는 뜻이고, 새로운 리소스를 **생성**하기 위한 요청. **바디를 사용한다**)<br/>

**URL** : 요청 자원 명시

**HTTP 버전** : 말 그대로 HTTP 버전 명시한거임


## HTTP 응답 메시지 구조

```
HTTP/1.1 200 OK
Date : Sun, 26 June ...
Server : Apache
Content-Length : 35
Content-Type : text/html

<h1>Hello World</h1>
```

위랑 똑같이 **Black Line(공백)** 존재.

### status line

위 메시지 코드에서 **맨 윗줄**을 까보면,

```
HTTP/1.1 200 OK

- HTTP/1.1 (HTTP 버전)

- 200 (Status code)

- OK (Status text)
```

### 헤더랑 바디의 역할

**Headers**

- Contents-type 과 Content-length가 중요한 헤더

- 네트워크상에서 데이터를 보낼 때 데이터의 형식을 나타내는 표준방식인 **MIME**를 사용

*MIME* : 미디어 타입, 서버는 모든 HTTP 객체에 이 타입을 붙임.

- Content-type : 보내는 자원의 형식을 명시(MIME 타입사용)

- Content-Length : body의 길이를 명시(바이트 단위)

**Body**

- 보통은 클라이언트가 요청한 HTML문서가 들어감.




## 소켓(Socket)

**네트워크 상에서 응용프로그램간을 연결**하는 프로그램(라이브러리).

**응용 프로그램에서 TCP/IP를 이용하기 위한 인터페이스** 역할.

TCP/IP 보면 감이 오지?

-> **소켓은 응용계층, 전송계층 사이에 위치.**

## 포트번호란?

**계층 속 프로그램 간** 부여된 번호가 있음.<br/>

**포트번호** : 0~65535

|HTTP(80)|Telnet(23)|FTP(21)|DNS(53)|
|--|--|--|--|
|TCP|UDP|||
|IP||||

아래서부터 차례대로 위로 올라가며<br/>
어떤 프로그램으로 가야하는지 내비 역할을 해줌.

## 소켓 프로그래밍시 절차.

|관점|1.소켓생성|2.연결 설정|3.통신|4.연결종료|
|--|--|--|--|--|
|서버|socket()->|blind()->listen()->accept()|->sendall(),recv()->|close()|
|클라이언트|socket()->|connect()->|sendall(),recv()->|close()|






